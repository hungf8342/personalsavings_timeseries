---
title: "Personal Savings Analysis"
author: "Frances Hung"
date: "11/6/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require(TSA)
require(dplyr)
```

```{r}
# load the time series
savings<-ts(read.csv("savings.csv",header=TRUE, nrows=104) %>% select(2), start=c(1955),frequency=4)

# plot the original time series with labels for quarters
plot(savings, xlab="Year (by Quarter)", 
     ylab= "Percent of Disposible Income", 
     main= "Time Series of Personal Savings in the US (1955-1980)")
points(y=savings,x=as.vector(time(savings)),pch=as.vector(season(savings)), cex=.75)
abline(mean(savings),0)
```
```{r}
# should we do a transformation?
boxcox = BoxCox.ar(savings)
boxcox$ci
lambda = boxcox$mle
lambda
```

```{r}
# use the eacf and best subsets to find a candidate model
eacf(savings)
sub = armasubsets(y=savings,nar=7,nma=7, y.name='test', ar.method='ols') 
plot(best.subsets)
```

```{r}
# take a difference of the series
diffs = (savings - zlag(savings))[2:104]
plot(diffs, type="o")
abline(0,0)
```





```{r}
# find candidate models for the differenced series
eacf(diffs)
best.subsets = armasubsets(y=diffs,nar=7,nma=7, y.name='test', ar.method='ols') 
plot(best.subsets)
```




```{r}
diffs<-(savings-zlag(savings))
fit<-lm(savings~diffs)
#predicts<-predict.lm(fit)
plot(diffs)
resids<-rstudent(fit)
hist(resids)
acf(resids)
pacf(resids,lag=90)

ar(diffs[3:length(diffs)-1],order.max=2,AIC=F,method="yw")
arima(savings,order=c(2,1,0),method='ML')
eacf(diffs[3:length(diffs)-1])
```


